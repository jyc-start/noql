{
  "bugfix": {
    "true-false": {
      "case1": {
        "expectedResults": [
          {
            "gbName": "first",
            "ubName": "second",
            "dateAchieved": null,
            "achieved": true
          },
          {
            "gbName": "second",
            "ubName": "first",
            "dateAchieved": "2023",
            "achieved": true
          }
        ]
      }
    },
    "current-date": {
      "case1": {
        "expectedResults": [
          {
            "Today": "$date-placeholder",
            "Today2": "$date-placeholder"
          }
        ]
      }
    },
    "join-fn": {
      "case1": {
        "expectedResults": [
          {
            "names": "Max,Andy"
          }
        ]
      }
    },
    "sort-order": {
      "case1": {
        "expectedResults": [
          {
            "c": {
              "clanId": "C2",
              "userCount": 2
            }
          },
          {
            "c": {
              "clanId": "C3",
              "userCount": 1
            }
          },
          {
            "c": {
              "clanId": "C1",
              "userCount": 1
            }
          }
        ]
      },
      "case2": {
        "expectedResults": [
          {
            "clanId": "C2",
            "userCount": 2
          },
          {
            "clanId": "C3",
            "userCount": 1
          },
          {
            "clanId": "C1",
            "userCount": 1
          }
        ]
      },
      "case3": {
        "expectedResults": [
          {
            "clanId": "C2",
            "userCount": 2
          },
          {
            "clanId": "C3",
            "userCount": 1
          },
          {
            "clanId": "C1",
            "userCount": 1
          }
        ]
      }
    },
    "coalesce": {
      "case1": {
        "expectedResults": [
          {
            "Price": 0,
            "inlineValue": 3
          },
          {
            "Price": 1,
            "inlineValue": 3
          },
          {
            "Price": 0,
            "inlineValue": 3
          },
          {
            "Price": 0,
            "inlineValue": 3
          }
        ]
      }
    },
    "rank": {
      "case1": {
        "expectedResults": [
          {
            "value": "A",
            "rank_number": 1
          },
          {
            "value": "A",
            "rank_number": 1
          },
          {
            "value": "B",
            "rank_number": 3
          },
          {
            "value": "B",
            "rank_number": 3
          },
          {
            "value": "B",
            "rank_number": 3
          },
          {
            "value": "C",
            "rank_number": 6
          },
          {
            "value": "E",
            "rank_number": 7
          }
        ]
      },
      "case2": {
        "expectedResults": [
          {
            "value": "A",
            "rank_number": 1
          },
          {
            "value": "A",
            "rank_number": 1
          },
          {
            "value": "B",
            "rank_number": 3
          },
          {
            "value": "B",
            "rank_number": 3
          },
          {
            "value": "B",
            "rank_number": 3
          },
          {
            "value": "C",
            "rank_number": 6
          },
          {
            "value": "E",
            "rank_number": 7
          }
        ]
      }
    },
    "row-number": {
      "case1": {
        "expectedResults": [
          {
            "value": "A",
            "row_number": 1
          },
          {
            "value": "A",
            "row_number": 2
          },
          {
            "value": "B",
            "row_number": 3
          },
          {
            "value": "B",
            "row_number": 4
          },
          {
            "value": "B",
            "row_number": 5
          },
          {
            "value": "C",
            "row_number": 6
          },
          {
            "value": "E",
            "row_number": 7
          }
        ]
      },
      "case2": {
        "expectedResults": [
          {
            "value": "A",
            "rank_number": 1
          },
          {
            "value": "A",
            "rank_number": 2
          },
          {
            "value": "B",
            "rank_number": 1
          },
          {
            "value": "B",
            "rank_number": 2
          },
          {
            "value": "B",
            "rank_number": 3
          },
          {
            "value": "C",
            "rank_number": 1
          },
          {
            "value": "E",
            "rank_number": 1
          }
        ]
      }
    },
    "dense-rank": {
      "case1": {
        "expectedResults": [
          {
            "value": "A",
            "rank_number": 1
          },
          {
            "value": "A",
            "rank_number": 1
          },
          {
            "value": "B",
            "rank_number": 2
          },
          {
            "value": "C",
            "rank_number": 3
          },
          {
            "value": "C",
            "rank_number": 3
          },
          {
            "value": "D",
            "rank_number": 4
          },
          {
            "value": "E",
            "rank_number": 5
          }
        ]
      },
      "case2": {
        "expectedResults": [
          {
            "value": "A",
            "rank_number": 1
          },
          {
            "value": "A",
            "rank_number": 1
          },
          {
            "value": "B",
            "rank_number": 2
          },
          {
            "value": "C",
            "rank_number": 3
          },
          {
            "value": "C",
            "rank_number": 3
          },
          {
            "value": "D",
            "rank_number": 4
          },
          {
            "value": "E",
            "rank_number": 5
          }
        ]
      }
    },
    "to_objectid": {
      "case1": {
        "expectedResults": [
          {
            "_id": "61b0fdcbdee485f7c0682db6",
            "i": "61b0fdcbdee485f7c0682db6"
          }
        ]
      }
    },
    "object_to_array": {
      "case1": {
        "expectedResults": [
          {
            "id": 1,
            "test": [
              {
                "k": "Address",
                "v": "1913 Hanoi Way"
              },
              {
                "k": "City",
                "v": "Sasebo"
              },
              {
                "k": "Country",
                "v": "Japan"
              },
              {
                "k": "District",
                "v": "Nagasaki"
              }
            ]
          }
        ]
      }
    },
    "special-char-parameters": {
      "case1": {
        "expectedResults": [
          {
            "parameter": "Isn't a \"bug\" just $"
          }
        ]
      },
      "case2": {
        "expectedResults": [
          {
            "parameter": "Isn't a \"bug\" just $"
          }
        ]
      },
      "case3": {
        "expectedResults": [
          {
            "id": 2,
            "val": 52
          },
          {
            "id": 3,
            "val": 55
          }
        ]
      }
    },
    "schema-aware-queries": {
      "cast-json-array-to-varchar": {
        "case1": {
          "expectedResults": [
            {
              "testId": "bugfix.schema-aware-queries.cast-json-array-to-varchar.case1",
              "jsonArrayStr": "[{\"string\":\"Testing\",\"integer\":1,\"boolean\":true,\"number\":1.5,\"nested\":{\"string\":\"Testing\",\"secondLevel\":{\"string\":\"Testing\"}}},{\"string\":\"Testing2\",\"integer\":null,\"boolean\":null,\"number\":null,\"nested\":{\"string\":null,\"secondLevel\":{\"string\":null}}}]"
            },
            {
              "testId": "bugfix.schema-aware-queries.cast-json-array-to-varchar.case2",
              "jsonArrayStr": null
            },
            {
              "testId": "bugfix.schema-aware-queries.cast-json-array-to-varchar.case3",
              "jsonArrayStr": null
            },
            {
              "testId": "bugfix.schema-aware-queries.cast-json-array-to-varchar.case4",
              "jsonArrayStr": null
            }
          ],
          "pipeline": [
            {
              "$match": {
                "testCategory": {
                  "$eq": "stringify"
                }
              }
            },
            {
              "$unset": [
                "_id"
              ]
            },
            {
              "$project": {
                "testId": "$testId",
                "jsonArrayStr": {
                  "$concat": [
                    "[",
                    {
                      "$reduce": {
                        "input": "$jsonArray",
                        "initialValue": "",
                        "in": {
                          "$concat": [
                            "$$value",
                            {
                              "$cond": [
                                {
                                  "$eq": [
                                    "$$value",
                                    ""
                                  ]
                                },
                                "",
                                ","
                              ]
                            },
                            "{",
                            {
                              "$cond": [
                                {
                                  "$eq": [
                                    {
                                      "$ifNull": [
                                        "$$this.string",
                                        null
                                      ]
                                    },
                                    null
                                  ]
                                },
                                "\"string\":null",
                                {
                                  "$concat": [
                                    "\"string\":\"",
                                    "$$this.string",
                                    "\""
                                  ]
                                }
                              ]
                            },
                            {
                              "$cond": [
                                {
                                  "$ifNull": [
                                    "$$this.string",
                                    ""
                                  ]
                                },
                                ",",
                                ""
                              ]
                            },
                            {
                              "$cond": [
                                {
                                  "$eq": [
                                    {
                                      "$ifNull": [
                                        "$$this.integer",
                                        null
                                      ]
                                    },
                                    null
                                  ]
                                },
                                "\"integer\":null",
                                {
                                  "$concat": [
                                    "\"integer\":",
                                    {
                                      "$toString": "$$this.integer"
                                    },
                                    ""
                                  ]
                                }
                              ]
                            },
                            {
                              "$cond": [
                                {
                                  "$ifNull": [
                                    "$$this.integer",
                                    ""
                                  ]
                                },
                                ",",
                                ""
                              ]
                            },
                            {
                              "$cond": [
                                {
                                  "$eq": [
                                    {
                                      "$ifNull": [
                                        "$$this.boolean",
                                        null
                                      ]
                                    },
                                    null
                                  ]
                                },
                                "\"boolean\":null",
                                {
                                  "$concat": [
                                    "\"boolean\":",
                                    {
                                      "$toString": "$$this.boolean"
                                    },
                                    ""
                                  ]
                                }
                              ]
                            },
                            {
                              "$cond": [
                                {
                                  "$ifNull": [
                                    "$$this.boolean",
                                    ""
                                  ]
                                },
                                ",",
                                ""
                              ]
                            },
                            {
                              "$cond": [
                                {
                                  "$eq": [
                                    {
                                      "$ifNull": [
                                        "$$this.number",
                                        null
                                      ]
                                    },
                                    null
                                  ]
                                },
                                "\"number\":null",
                                {
                                  "$concat": [
                                    "\"number\":",
                                    {
                                      "$toString": "$$this.number"
                                    },
                                    ""
                                  ]
                                }
                              ]
                            },
                            {
                              "$cond": [
                                {
                                  "$ifNull": [
                                    "$$this.number",
                                    ""
                                  ]
                                },
                                ",",
                                ""
                              ]
                            },
                            "\"nested\":",
                            {
                              "$concat": [
                                "{",
                                {
                                  "$cond": [
                                    {
                                      "$eq": [
                                        {
                                          "$ifNull": [
                                            "$$this.nested.string",
                                            null
                                          ]
                                        },
                                        null
                                      ]
                                    },
                                    "\"string\":null",
                                    {
                                      "$concat": [
                                        "\"string\":\"",
                                        "$$this.nested.string",
                                        "\""
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "$cond": [
                                    {
                                      "$ifNull": [
                                        "$$this.nested.string",
                                        ""
                                      ]
                                    },
                                    ",",
                                    ""
                                  ]
                                },
                                "\"secondLevel\":",
                                {
                                  "$concat": [
                                    "{",
                                    {
                                      "$cond": [
                                        {
                                          "$eq": [
                                            {
                                              "$ifNull": [
                                                "$$this.nested.secondLevel.string",
                                                null
                                              ]
                                            },
                                            null
                                          ]
                                        },
                                        "\"string\":null",
                                        {
                                          "$concat": [
                                            "\"string\":\"",
                                            "$$this.nested.secondLevel.string",
                                            "\""
                                          ]
                                        }
                                      ]
                                    },
                                    "}"
                                  ]
                                },
                                "}"
                              ]
                            },
                            "}"
                          ]
                        }
                      }
                    },
                    "]"
                  ]
                }
              }
            }
          ]
        }
      }
    }
  }
}